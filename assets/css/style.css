---
---
/* ===============================
   Rekiden Theme (Dark Wood, Gloss Maple) — one-sheet background
   using /assets/bg/rekiden-wood-gloss.png
   =============================== */

/* ---- Global scope ---- */
body.theme-rekiden {
  /* Colors & typography */
  --rk-ink:    #f4f1e6;  /* body text */
  --rk-head:   #f0d090;  /* headings */
  --rk-accent: #b48a60;  /* borders / accents */

  /* Table stripe colors (never white) */
  --rk-row-odd:  rgba(180,138,96,.16);
  --rk-row-even: rgba(120, 90,60,.26);

  color: var(--rk-ink);
  font-family: "Noto Serif JP","Hiragino Mincho ProN","Yu Mincho","Times New Roman",serif;
  font-feature-settings: "palt" 1, "pkna" 1;
  font-size: 17px;
  line-height: 1.85;

  /* === Background: glossy light-walnut (one-sheet, no tile) === */
  /* tweak these 3 for framing the knot/highlight */
  --rk-wood-width: 1500px;  /* 1200–1800px で調整 */
  --rk-wood-pos-x: 55%;     /* 0% left – 100% right */
  --rk-wood-pos-y: 20%;     /* 15–30%: upper highlight/knot */

  background-color: #d6a762; /* prepaint base while image loads */
  background-image: url("{{ '/assets/bg/rekiden-wood-gloss.png' | relative_url }}?v={{ site.time | date: '%s' }}");
  background-repeat: no-repeat;
  background-size: var(--rk-wood-width) auto;             /* cover→固定幅で見せる */
  background-position: var(--rk-wood-pos-x) var(--rk-wood-pos-y);
  background-attachment: scroll;                          /* iPad/Safari 安定優先 */
  background-blend-mode: normal;
}

/* Responsive wood sizing (optional) */
@media (max-width: 900px){
  body.theme-rekiden{ --rk-wood-width: 1180px; --rk-wood-pos-y: 20%; }
}
@media (min-width: 1600px){
  body.theme-rekiden{ --rk-wood-width: 1750px; --rk-wood-pos-y: 22%; }
}

/* ---- Content panel (semi-transparent to show wood) ---- */
body.theme-rekiden main.page,
body.theme-rekiden .page-content > .wrapper {
  background: rgba(60, 40, 25, .60); /* 0.58–0.66 で好み調整 */
  color: var(--rk-ink);
  border: 1px solid rgba(255,255,255,.14);
  border-radius: 10px;
  box-shadow: 0 4px 12px rgba(0,0,0,.6);
  padding: min(2.0vw, 1.5rem);
}

/* ---- Optional: subtle gloss highlight overlay ---- */
/* 艶感を少しだけ足したい場合は opacity を 0.12–0.22 で調整 */
body.theme-rekiden::after{
  content:"";
  position:fixed; inset:0; pointer-events:none; z-index:-1;
  background:
    linear-gradient( 18deg, rgba(255,255,255,.22) 0%, rgba(255,255,255,0) 28%),
    radial-gradient(ellipse at 42% 12%, rgba(255,255,255,.10), rgba(255,255,255,0) 55%);
  mix-blend-mode: screen;
  opacity:.18;
}

/* ---- Vignette (very light edge falloff) ---- */
body.theme-rekiden::before {
  content: "";
  position: fixed; inset: 0;
  pointer-events: none; z-index: -1;
  background:
    radial-gradient(ellipse at 50% 30%, rgba(0,0,0,.05), transparent 60%),
    linear-gradient(to bottom, rgba(0,0,0,.06), rgba(0,0,0,.10));
  mix-blend-mode: normal;
  opacity: .30;
}

/* ---- Headings ---- */
body.theme-rekiden h1,
body.theme-rekiden h2,
body.theme-rekiden h3 {
  color: var(--rk-head);
  font-weight: 700;
  border-bottom: 2px solid var(--rk-accent);
  padding-bottom: 4px;
  margin: 1.1em 0 .6em;
}
body.theme-rekiden h1 { font-size: 2rem; }
body.theme-rekiden h2 { font-size: 1.6rem; }
body.theme-rekiden h3 { font-size: 1.3rem; }

/* ---- Links ---- */
body.theme-rekiden a {
  color: #f0c060;
  font-weight: 600;
  text-decoration: none;
}
body.theme-rekiden a:hover {
  color: #dba84f;
  text-decoration: underline;
}

/* ---- Blockquote ---- */
body.theme-rekiden blockquote {
  margin: .9em 0;
  padding: .7em 1em;
  color: #fff1d8;
  background: rgba(255,255,255,.08);
  border-left: 6px solid var(--rk-accent);
  border-radius: 6px;
}

/* ---- Tables (no white float; warm stripes) ---- */
body.theme-rekiden .table-wrap { overflow: auto; border-radius: 8px; }

body.theme-rekiden table {
  width: 100%;
  border-collapse: collapse;
  margin: 1em 0;
  border: 1.5px solid rgba(255,255,255,.14);
  background: transparent;
}

body.theme-rekiden table,
body.theme-rekiden table th,
body.theme-rekiden table td {
  background: transparent !important;
  color: var(--rk-ink);
  border: 1px solid rgba(255,255,255,.16);
}

body.theme-rekiden tbody tr:nth-child(odd)  { background-color: var(--rk-row-odd); }
body.theme-rekiden tbody tr:nth-child(even) { background-color: var(--rk-row-even); }

body.theme-rekiden thead th {
  background-color: rgba(255,220,160,.18) !important;
  color: #fff5dc !important;
  font-weight: 700;
  text-align: left;
  border: 1.5px solid rgba(255,255,255,.16);
}

body.theme-rekiden td,
body.theme-rekiden th { padding: .7em .9em; }

body.theme-rekiden tbody tr:hover {
  background-color: rgba(180,138,96,.34) !important;
}

/* ---- Mobile tweaks ---- */
@media (max-width: 640px) {
  body.theme-rekiden h1 { font-size: 1.7rem; }
  body.theme-rekiden h2 { font-size: 1.35rem; }
  body.theme-rekiden main.page,
  body.theme-rekiden .page-content > .wrapper { padding: 16px 12px; }
}

/* ---- Motion/Perf friendly ---- */
@media (prefers-reduced-motion: reduce) {
  /* 背景はすでに scroll だが、今後の演出追加に備え */
  * { transition: none !important; animation: none !important; }
}

/* ===== DEBUG: 木目を強制表示（上物を全部オフ） ===== */
body.theme-rekiden {
  background-image: url("/Rekiden/assets/bg/rekiden-wood-gloss.png") !important;
  background-repeat: no-repeat !important;
  background-size: 1500px auto !important;  /* 好みで 1200–1800px */
  background-position: 55% 20% !important;  /* 節の位置調整 */
  background-attachment: scroll !important;
}

/* body のオーバーレイを完全無効化 */
body.theme-rekiden::before,
body.theme-rekiden::after { content: none !important; }

/* パネルの不透明色を一旦オフ */
body.theme-rekiden main.page,
body.theme-rekiden .page-content > .wrapper {
  background: transparent !important;
}

/* もし wrapper に木目を敷いていたら、それも一旦オフ */
body.theme-rekiden .page-content > .wrapper::before { content: none !important; }

/* ===== Rekiden: WOOD PASSTHROUGH / no-block mode ===== */
/* 1) 本文パネル・ヘッダ/フッタ・カード等の背景を強制透明化 */
body.theme-rekiden :where(
  main.page,
  .page-content,
  .page-content > .wrapper,
  header, .site-header,
  footer, .site-footer,
  .card, .panel, .box, .section, .hero, .masthead
){
  background: transparent !important;
  backdrop-filter: none !important;
}

/* 2) これまで追加したオーバーレイ類を無効化（木目に何も乗せない） */
body.theme-rekiden::before,
body.theme-rekiden::after,
body.theme-rekiden .page-content > .wrapper::before {
  content: none !important;
  background: none !important;
  opacity: 0 !important;
  mix-blend-mode: normal !important;
}

/* 3) 影・枠だけでメリハリを出す（背景は透明のまま） */
body.theme-rekiden :where(
  .page-content > .wrapper,
  .card, .panel, .box
){
  border: 1px solid rgba(0,0,0,.25) !important;
  box-shadow: 0 6px 18px rgba(0,0,0,.35) !important;
  border-radius: 10px !important;
}

/* 4) テーブル/見出しはもともと半透明指定だが、念のため完全透明に揃える */
body.theme-rekiden table,
body.theme-rekiden table th,
body.theme-rekiden table td,
body.theme-rekiden thead th {
  background: transparent !important;
}

/* 5) ヒーロー帯や区切り帯で背景色を使っているクラス名の保険 */
body.theme-rekiden [class*="bg-"],
body.theme-rekiden [class*="band"],
body.theme-rekiden [class*="banner"]{
  background: transparent !important;
}

/* 6) 余白は維持（読みやすさ用） */
body.theme-rekiden .page-content > .wrapper { padding: min(2vw, 1.5rem) !important; }

/* ===== N U K E 版：木目を塞ぐ背景を全消し（一時的） ===== */

/* 1) body直下～本文内のすべての背景を透明化（画像/グラデも含む） */
body.theme-rekiden *:not(img):not(svg):not(canvas) {
  background: transparent !important;
  background-image: none !important;
  backdrop-filter: none !important;
}

/* 2) 擬似要素の背景も完全OFF（帯やマスクの犯人になりがち） */
body.theme-rekiden *::before,
body.theme-rekiden *::after {
  content: none !important;
  background: none !important;
  opacity: 0 !important;
  mix-blend-mode: normal !important;
}

/* 3) ページの主要コンテナやヘッダ/フッタも明示で透明に */
body.theme-rekiden :where(
  html, body, main, header, footer, nav, aside,
  .site-header, .site-footer, .page-content, .wrapper,
  .hero, .band, .banner, .section, .container, .panel, .card, .box
) {
  background: transparent !important;
  background-image: none !important;
}

/* 4) 影・枠だけは残して読みやすさ確保（必要に応じて消してOK） */
body.theme-rekiden :where(.wrapper, .panel, .card, .box) {
  border: 1px solid rgba(0,0,0,.25) !important;
  box-shadow: 0 6px 18px rgba(0,0,0,.35) !important;
  border-radius: 10px !important;
}
